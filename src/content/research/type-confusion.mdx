---
title: Type-Confusion Security
abstract: Type systems are a lightweight way to obtain assurance that code enjoys useful properties, including security properties. But in decentralized settings such as smart contracts and federated distributed systems, malicious adversaries may not obey the type system. They may attempt to confuse trusted code by supplying values that do not behave as their advertised type claims. We show that well-known attacks such as Confused Deputy Attacks (CDAs) and reentrancy attacks can be understood as instances of this kind of type confusion. In this paper, we show how to obtain the guarantees of a type system despite the presence of malicious type confusion, using a novel mechanism that combines static and dynamic information flow checking. We give an information-flow-typed core calculus with a run-time enforcement mechanism, and formally prove the security of this mechanism as a hyperproperty-preserving simulation between ill-typed and well-typed programs. With this mechanism, programmers can write code while pretending that adversaries are constrained to obey the type system. The security properties enforced by this ideal system continue to hold in the real system where adversaries lie about types.
status: Silei Ren, Suraaj Kanniwadi, Hanxi Chen, Andrew C. Myers; In Submission
url: /type-confusion.pdf
order: 4
---